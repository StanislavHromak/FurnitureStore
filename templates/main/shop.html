{% extends 'base.html' %}
{% load static %}
{% block title %}–ú–∞–≥–∞–∑–∏–Ω - –ú–∞–≥–∞–∑–∏–Ω –º–µ–±–ª—ñ–≤{% endblock %}
{% block content %}
<div class="design_section layout_padding">
    <div class="container">
        <h1 class="design_taital">–ù–∞—à—ñ —Ç–æ–≤–∞—Ä–∏</h1>
        <p class="design_text">–û–∑–Ω–∞–π–æ–º—Ç–µ—Å—è –∑ –Ω–∞—à–∏–º–∏ —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º–∏ –º–µ–±–ª—è–º–∏</p>

        <!-- üîç –§–æ—Ä–º–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó -->
        <form method="get" action="{% url 'shop' %}" class="mb-4">
            <div class="form-row">
                <div class="col">
                    <input type="text" name="search" class="form-control" placeholder="–ü–æ—à—É–∫..." value="{{ search_query }}">
                </div>
                <div class="col">
                    <div class="dropdown">
                        <button class="btn btn-primary btn-block dropdown-toggle" type="button" id="categoryDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            {% if selected_category %}
                                {% for category in categories %}
                                    {% if category.id == selected_category %}
                                        {{ category.name }}
                                    {% endif %}
                                {% endfor %}
                            {% else %}
                                –í–∏–±—Ä–∞—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ—é
                            {% endif %}
                        </button>
                        <div class="dropdown-menu" aria-labelledby="categoryDropdown">
                            <a class="dropdown-item" href="{% url 'shop' %}?{% if search_query %}search={{ search_query }}&{% endif %}{% if price_min %}price_min={{ price_min }}&{% endif %}{% if price_max %}price_max={{ price_max }}{% endif %}">–í—Å—ñ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó</a>
                            {% for category in categories %}
                                <a class="dropdown-item" href="{% url 'shop' %}?category={{ category.id }}{% if search_query %}&search={{ search_query }}{% endif %}{% if price_min %}&price_min={{ price_min }}{% endif %}{% if price_max %}&price_max={{ price_max }}{% endif %}">{{ category.name }}</a>
                            {% empty %}
                                <a class="dropdown-item" href="#">–ö–∞—Ç–µ–≥–æ—Ä—ñ—ó –≤—ñ–¥—Å—É—Ç–Ω—ñ</a>
                            {% endfor %}
                        </div>
                        <input type="hidden" name="category" id="categoryInput" value="{{ selected_category|default_if_none:'' }}">
                    </div>
                </div>
                <div class="col">
                    <input type="number" name="price_min" class="form-control" placeholder="–¶—ñ–Ω–∞ –≤—ñ–¥" value="{{ price_min }}">
                </div>
                <div class="col">
                    <input type="number" name="price_max" class="form-control" placeholder="–¶—ñ–Ω–∞ –¥–æ" value="{{ price_max }}">
                </div>
                <div class="col">
                    <button type="submit" class="btn btn-primary btn-block">–ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏</button>
                </div>
            </div>
        </form>


        <!-- ü™ë –¢–æ–≤–∞—Ä–∏ -->
        <div class="design_section_2">
            <div class="row">
                {% for product in products %}
                    <div class="col-md-4 mb-4">
                        <div class="box_main">
                            <p class="chair_text">{{ product.name }}</p>
                            <div class="image_3">
                                {% if product.image %}
                                    <img src="{{ product.image.url }}" alt="{{ product.name }}">
                                {% else %}
                                    <p>–ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤—ñ–¥—Å—É—Ç–Ω—î</p>
                                {% endif %}
                            </div>
                            <p class="chair_text">–¶—ñ–Ω–∞: {{ product.price }} –≥—Ä–Ω</p>
                            <div class="buy_bt"><a href="{% url 'catalog:product_detail' product.id %}">–î—ñ–∑–Ω–∞—Ç–∏—Å—è –±—ñ–ª—å—à–µ</a></div>
                        </div>
                    </div>
                {% empty %}
                    <p class="design_text" style="text-align: center;">–¢–æ–≤–∞—Ä—ñ–≤ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ.</p>
                {% endfor %}
            </div>
        </div>

        <div class="read_bt"><a href="{% url 'main:home' %}">–ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –Ω–∞ –≥–æ–ª–æ–≤–Ω—É</a></div>
    </div>
</div>
{% endblock %}
